<!DOCTYPE html>
<head>
    <title>My Compassion App 2.0 </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/jquery.mobile-1.4.2.min.css"/>
    <link rel="stylesheet" href="css/flexslider.css"/>
    <link rel="stylesheet" href="css/style.css"/>

    <script src="js/jquery-1.11.1.min.js"></script>
    <script src="js/jquery.mobile-1.4.2.min.js"></script>
    <script src="js/jquery.flexslider.js"></script>
    <script type="text/javascript" language="javascript" src="quotes.json"></script>
</head>
<body>
<div data-role="page" id="homePage" style="height:100%">
    <div data-role="header" data-position="fixed">
        <h1 style="font-size:24px;">Kindness App</h1>
    </div>
    <div class="content" data-role="content">
    	<div class="quoteContainer">
    		<h1>Daily Quote</h1>
    		<p id="quote"></p>
    		<p>By <span id="author"></span></p>
    	</div>
        <div class="flexslider">
            <ul class="slides">
                <li>
                    <br/>
                    <br/>

                    <h1>1. Our mission</h1>
                    <br/>

                    <p>Montreal City Mission</p>

                    <p>enables</p>

                    <p>the journey from exclusion to community.</p>
                    <br/>
                    <br/>
                    <br/>
                </li>
                <li>
                    <br/>
                    <br/>

                    <h1>2. Our mission</h1>
                    <br/>

                    <p>Montreal City Mission</p>

                    <p>enables</p>

                    <p>the journey from exclusion to community.</p>
                    <br/>
                    <br/>
                </li>
                <li>
                    <br/>
                    <br/>

                    <h1>3. Our mission</h1>
                    <br/>

                    <p>Montreal City Mission</p>

                    <p>enables</p>

                    <p>the journey from exclusion to community.</p>
                    <br/>
                    <br/>
                </li>
            </ul>
        </div>
    </div>
    <div class="center" data-role="footer" data-position="fixed">
        <a class="btn-start"
                href="startingTimer.html"
                data-ajax="false" data-transition="flip">Start Meditation</a>
    </div>
</div>
<script type="text/javascript">
    function doResize() {
        var winhight = $.mobile.getScreenHeight();
        var headhight = $('[data-role="header"]').first().outerHeight();
        var foothight = $('[data-role="footer"]').first().outerHeight();
        var $content = $('[data-role="content"]');
        newhight = winhight - headhight - foothight;
        $content.css('min-height', newhight + 'px');
    }
    $(document).bind('pageshow', doResize);
    
    var applaunchCount = window.localStorage.getItem('launchCount');
        //Check if it already exists or not
        if (applaunchCount) {
            $('.flexslider').css('display','none');
            var start = new Date(window.localStorage.getItem("startDate"));
			var end = new Date();
			var diff = new Date(end - start);
			var days = Math.floor(diff/1000/60/60/24);
			$("#quote").html(jsonObject.Quote[days].Content);
			$("#author").html(jsonObject.Quote[days].Writer);
        } else {
        	window.localStorage.setItem('launchCount', 1);
        	
        	// record the first day the user use the app in order to count the days to show the proper quote
        	var startdate = new Date(); 
		  	var datetime = startdate.getFullYear()+'-'+(startdate.getMonth()+1)+'-'+startdate.getDate();
		  	window.localStorage.setItem("startDate",datetime);
		  	alert("Your first time using this app "+window.localStorage.getItem("startDate"));
        	$('.quoteContainer').css('display','none');
        	$(".btn-start").css("opacity", "0");
            //Local storage is not set, hence first time launch. set the local storage item
            $(document).delegate("#homePage", "pageinit", function () {
	        $('.flexslider').flexslider({
		            directionNav: false,
		            animation: "slide",
		            slideshow: false,
		            end: function(){
		                $(".btn-start").css("opacity", "1");
		                $('.flexslider').css('display','none');
		                $('.quoteContainer').css('display','block');
		            }
		        });
		    });
            alert("Welcome to the Kindness App");


            //Do the other stuff related to first time launch
        }
    
    $(window).bind('resize orientationchange', doResize);
</script>
</body>
